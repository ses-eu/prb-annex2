[Annual Monitoring Report {{< var doc.year_report >}} - {{< var doc.country >}}]{.fakeh1}

## Contextual information
*`r pp_version`*

<!-- ******************* 1st column -->
::: columns
:::: {.column width="30%"}
::::: columns
:::::: {.column width="50%"}
**List of ACCs  ** `r acc_no`
::::::

:::::: {.column width="50%"}
`r acc1`<br/>`r acc2`<br/>`r acc3`<br/>`r acc4`<br/>`r acc5`
::::::
:::::

::::: columns
:::::: {.column width="50%"}
**No of airports in the scope of the performance plan**
::::::

:::::: {.column width="50%"}
**≥80'K    ** `r no_apt_big`<br/> **<80'K     ** `r no_apt_small`
::::::
:::::
::::

<!-- ******************* 2nd column -->
:::: {.column width="38%"}
<p style="margin-bottom: 0.5rem"> **Share of Union-wide traffic (TSUs) `r year_report` **  `r tsu_share` </p>

<p style="margin-bottom: 0.5rem"> **Share of Union-wide en route costs `r year_report` ** `r ert_cost_share` </p>

**Share en route / terminal costs `r year_report` ** `r ert_trm_share`

::::: columns
:::::: {.column width="50%"}
**En route charging zone(s)**
::::::

:::::: {.column width="50%"}
```{r}
ecz_list_string <- paste0(
  ecz_list$ecz_name[1],
  if_else(is.na(ecz_list$ecz_name[2]) == TRUE, '' ,  paste0('<br/>', ecz_list$ecz_name[2]))
)
```

`r ecz_list_string`

::::::
:::::

::::: columns
:::::: {.column width="50%"}
[**Terminal charging zone(s)**]{.context-text}
::::::

:::::: {.column width="50%"}
```{r}
tcz_list_string <- if_else(no_tcz == 0, '',
                           paste0(tcz_list$tcz_name[1], 
                                  if_else(is.na(tcz_list$tcz_name[2]) == TRUE, '' ,  
                                          paste0('<br/>', tcz_list$tcz_name[2])
                                          )
                                  )
                           )
```

`r tcz_list_string`

::::::
:::::
::::

<!-- ******************* 3rd column -->
:::: {.column width="32%"}
::::: columns
:::::: {.column width="30%"}
**Main ANSP ** 
::::::

:::::: {.column width="70%"}
• `r main_ansp`
::::::
:::::

::::: columns
:::::: {.column width="30%"}
**Other ANSPs **
::::::

:::::: {.column width="70%"}
`r other_ansps_str`
::::::
:::::

::::: columns
:::::: {.column width="30%"}
**MET Providers **
::::::

:::::: {.column width="70%"}
`r other_met_str`
::::::
:::::

::::
:::

## Traffic (En route traffic zone)

::: {#container-mvt}
:::: {#chart-mvt class="mychart"}
```{r chart-mvt}
#| file: R/chart_level1_traffic_mvt.R
#| out.width: "100%"
```
::::

:::: {#concl-mvt}
```{r concl-mvt}
mvt_conc <- read_mytable("PRB_findings.xlsx", "traffic_IFR", "Table_Findings_traffic_IFR") %>% 
  filter(Year_Report == params$year_report, State == params$country) %>% 
  select(Conclusion) %>% toString() %>% paste0(., "@")

mvt_conc1 <- mvt_conc %>% str_replace_all(c('", ' = '\n\n', '\"' = '', '\n\n\n' = '\n\n')) %>% str_replace(fixed('c('), '') %>%  str_replace(fixed(')@'), '') 
```

`r mvt_conc1`
::::
:::

::: {#container-su style="clear: both"}

<br>

:::: {#chart-su class="mychart"}
```{r chart-su}
#| file: R/chart_level1_traffic_su.R
#| out.width: "100%"
```
::::

:::: {#concl-su}
```{r concl-su}
tsu_conc <- read_mytable("PRB_findings.xlsx", "traffic_SUs", "Table_Findings_traffic_TSU") %>% 
  filter(Year_Report == params$year_report, State == params$country) %>% 
  select(Conclusion) %>% toString() %>% paste0(., "@")

tsu_conc1 <- tsu_conc %>% str_replace_all(c('", ' = '\n\n', '\"' = '', '\n\n\n' = '\n\n')) %>% str_replace(fixed('c('), '') %>%  str_replace(fixed(')@'), '') 
```

`r tsu_conc1`
::::
:::

::: {#container-saf style="clear: both"}
<!-- empty line to ensure next heading leaves enough space -->
<div style="height: 1px"></div>

## Safety (Main ANSP)

:::: {#chart-saf class="mychart"}
```{r chart-saf}
#| file: R/chart_level1_saf.R
#| out.width: "100%"
```
::::

:::: {#concl-saf}
```{r concl-saf}
saf_conc <- read_mytable("PRB_findings.xlsx", "safety", "Table_Findings_safety") %>% 
  filter(Year_Report == params$year_report, State == params$country) %>% 
  select(Conclusion) %>% toString() %>% paste0(., "@")

saf_conc1 <- saf_conc %>% str_replace_all(c('", ' = '\n\n', '\"' = '', '\n\n\n' = '\n\n')) %>% str_replace(fixed('c('), '') %>%  str_replace(fixed(')@'), '\n') 
```

`r saf_conc1`
::::
:::

::: {#container-env style="clear: both"}

<!-- empty line to ensure next heading leaves enough space -->
<div style="height: 1px"></div>

## Environment (Member State)

:::: {#chart-env class="mychart"}
```{r chart-env-kea, options = (doclevel=c("level1"))}
#| file: R/chart_level1_kea.R
#| out.width: "100%"
```
::::

:::: {#concl-env}
```{r concl-env}
env_conc <- read_mytable("PRB_findings.xlsx", "environment", "Table_Findings_environment") %>% 
  filter(Year_Report == params$year_report, State == params$country) %>% 
  select(Conclusion) %>% toString() %>% paste0(., "@")

env_conc1 <- env_conc %>% str_replace_all(c('", ' = '\n\n', '\"' = '', '\n\n\n' = '\n\n')) %>% str_replace(fixed('c('), '') %>%  str_replace(fixed(')@'), '\n') 
```

`r env_conc1`
::::
:::

::: {#container-cap style="clear: both"}

## Capacity (Member State)
<!-- empty line to ensure next heading leaves enough space -->
<div style="height: 1px"></div>

:::: {#chart-cap class="mychart"}
```{r chart-cap-er, options = (cztype=c("enroute"))}
#| file: R/chart_level1_cap.R
#| out.width: "100%"
```

`r if (params$no_tcz == 0) "::::: {.content-hidden}"`
<br>

```{r chart-cap-trm, options = (cztype=c("terminal"))}
#| file: R/chart_level1_cap.R
#| out.width: "100%"
```

`r if (params$no_tcz == 0) ":::::"`
::::

:::: {#concl-cap}
```{r concl-cap}
cap_er_conc <- read_mytable("PRB_findings.xlsx", "ER_capacity", "Table_Findings_ER_capacity") %>% 
  filter(Year_Report == params$year_report, State == params$country) %>% 
  select(Conclusion) %>% toString() %>% paste0(., "@")

cap_er_conc1 <- cap_er_conc %>% str_replace_all(c('", ' = '\n\n', '\"' = '', '\n\n\n' = '\n\n')) %>% str_replace(fixed('c('), '') %>%  str_replace(fixed(')@'), '\n') 
```

`r cap_er_conc1`
::::
:::

::: {#container-cef style="clear: both"}
<!-- empty line to ensure next heading leaves enough space -->
<div style="height: 1px"></div>

## Cost-efficiency (En route/Terminal charging zone(s))

:::: {#chart-cef-1 class="mychart"}
```{r chart-cef-er-1, options = (cz=c("1", "enroute"))}
#| file: R/chart_level1_cef.R
#| out.width: "100%"
```

<br>

`r if (params$no_ecz < 2) "::::: {.content-hidden}"`

```{r chart-cef-er-2, options = (cz=c("2", "enroute"))}
#| file: R/chart_level1_cef.R
#| out.width: "100%"
```

`r if (params$no_ecz < 2) ":::::"`


`r if (params$no_tcz == 0) "::::: {.content-hidden}"`
<br>

```{r chart-cef-trm-1, options = (cz=c("1", "terminal"))}
#| file: R/chart_level1_cef.R
#| out.width: "100%"
```

`r if (params$no_tcz == 1) ":::::: {.content-hidden}"`
<br>

```{r chart-cef-trm-2, options = (cz=c("2", "terminal"))}
#| file: R/chart_level1_cef.R
#| out.width: "100%"
```

`r if (params$no_tcz == 1) "::::::"`

`r if (params$no_tcz == 0) ":::::"`
::::

:::: {#concl-cef}
```{r concl-cef}
cef_conc <- read_mytable("PRB_findings.xlsx", "cost-efficiency", "Table_Findings_CEFF") %>% 
  filter(Year_Report == params$year_report, State == params$country) %>% 
  select(Conclusion) %>% toString() %>% paste0(., "@")

cef_conc1 <- cef_conc %>% str_replace_all(c('", ' = '\n\n', '\"' = '', '\n\n\n' = '\n\n')) %>% str_replace(fixed('c('), '') %>%  str_replace(fixed(')@'), '\n') 
```

`r cef_conc1`
::::
:::
