project:
  type: book
  output-dir: _book

execute:
  freeze: false
  echo: false
  warning: false
  fig-process: pdfcrop

format:
  pdf: 
    fig-crop: true
    fig-pos: 'H'
    keep-tex: true
    toc: true
    lof: false
    # fig-format: "pdf"
    geometry:
      - a4paper
      # - showframe
      # - inner=3cm
      # - outer=4cm
      - top=2cm
      - bottom=1cm
      - left=2.5cm
      - right=2.2cm
      - footskip=0.7cm
    mainfont: "Roboto"
    include-in-header:
      - text: |
          % cover page, header and footer
          \usepackage{graphicx}  % Allows inserting images
          \usepackage{eso-pic}   % Enables full-page backgrounds
          \usepackage{everypage} % Alternative package for first-page modifications
          \usepackage{hyperref}  % Enables hyperlinks
          \hypersetup{colorlinks=true, urlcolor=blue} % Set hyperlinks to be blue and underlined
          
          \usepackage{xcolor}    % Enables text color customization
          \definecolor{PRBBlue}{HTML}{0563C1} % Define PRB blue color
          
          \newcommand\CoverImage{images/background_cover_page.png} % Background image path
    
          % Add background to the first page
          \AddToShipoutPictureBG*{%
            \AtPageLowerLeft{\includegraphics[width=\paperwidth,height=\paperheight]{\CoverImage}}
          }
    
          \usepackage{scrlayer-scrpage} % For customizing headers/footers
          \clearpairofpagestyles
    
          % Ensure the last page reference is available
          \usepackage{lastpage}
    
          % Add the logo in the center of the header
          \chead*{\raisebox{10mm}{\includegraphics[height=0.18cm]{images/header_top.png}}}
    
          % Move page numbering to the right-hand side of the header with new font style
          \ohead*{\makebox[0pt][r]{\raisebox{-10mm}{\textcolor{black}{\robotoLight\normalfont\fontsize{8pt}{10pt}\selectfont \thepage/\pageref*{LastPage}}}}}
          
          \usepackage{titling}   % Allows title repositioning
          \usepackage{fontspec}  % Custom fonts
          \newfontfamily\robotoLight{Roboto Light} % Define Roboto Light for title

           % Apply color and keep the existing formatting
          \pretitle{\vspace*{-2cm} % Moves title
                    \begin{flushleft} % Align title left
                    \color{PRBBlue} % Apply color
                    \robotoLight\fontsize{24pt}{26pt}\selectfont} % Custom font size
          \posttitle{\\[2mm] % Add small space after title
                    \robotoLight\fontsize{24pt}{26pt}\selectfont Monitoring Report % Hardcoded subtitle
                    \end{flushleft}}
    
          % Apply color to the author (keeps spacing and format)
          \preauthor{\vspace*{6mm} % Extra spacing between title and author
                     \begin{flushleft} % Align left
                     \color{PRBBlue} % Apply color
                     \robotoLight\fontsize{21pt}{23pt}\selectfont} % Set font size for author
          \postauthor{\end{flushleft}}
    
          % Apply color to the date
          \predate{\vspace*{5mm} \begin{flushleft}\color{PRBBlue}\small} % Moves date down slightly
          \postdate{\end{flushleft}}
      
          % Add text "This report is automatically generated from: sesperformance.eu"
          % Position it lower on the cover page
          \AddToShipoutPictureBG*{%
            \AtPageLowerLeft{%
              \hspace{24mm} % Move right slightly
              \raisebox{40mm}{ % Move up from bottom of page
                {\robotoLight\fontsize{10pt}{12pt}\selectfont % Set font size
                \textcolor{black}{This report is automatically generated from: } 
                \href{https://sesperformance.eu}{sesperformance.eu} % Default hyperlink (blue, underlined)
                }
              }
            }
          }

          % Add disclaimer in the footer of the first page only (full-width, 6pt font)
          \AddToShipoutPictureBG*{%
            \ifnum\value{page}=1
              \AtPageLowerLeft{\hspace{24mm}\raisebox{10mm}{ % Move right by 10mm, up by 10mm
                \fontsize{7pt}{9pt}\selectfont % Set font size to 6pt with 8pt line spacing
                \parbox{\linewidth}{ % Full width of the text area
                  \raggedright % Left-align text
                  Performance Review Body of the Single European Sky \textbar\ Rue de la Fusée 96, Office 50.659, 1130 Brussels \\[2pt]
                  Office Telephone: +32 (0)2 234 7824 \textbar\ cathy.mannion@prb.eusinglesky.eu \textbar\ prb-office@prb.eusinglesky.eu \textbar\ eu-single-sky.transport.ec.europa.eu
                }
              }}
            \fi
          }
          

          \usepackage[section]{placeins} % Prevent floats from crossing section boundaries
      
          \usepackage{array} % Add advanced table formatting
          \newcolumntype{P}[1]{>{\raggedright\arraybackslash}p{#1}} % Left-aligned column without word breaking          
          
          \usepackage{float} % Allows [H] placement option
          \makeatletter
          \setlength{\@fptop}{0pt} % Place floats at the top of the page
          \setlength{\@fpsep}{\textheight} % Avoid stacking other floats below
          \makeatother

          \usepackage[table, dvipsnames]{xcolor}

          \usepackage{ragged2e} % for justifying text in multiple column layout
          \usepackage{wrapfig}
          \usepackage{subfig}
       
          \usepackage[utf8]{inputenc} % Ensure UTF-8 support for character encoding
          \usepackage{textcomp}       % Additional text symbols
          \usepackage{amssymb}        % Enable ✓ and ✘ symbols
          \usepackage{fontspec}       % Allow custom fonts for LaTeX
          \setmainfont{Roboto}        % Set Roboto as the main font  
          \newfontfamily{\symbolfont}{Segoe UI Symbol} % Set fallback for symbols
          \DeclareTextFontCommand{\textsymbol}{\symbolfont} % Define fallback symbol command          

          % Define commands for green ticks and red crosses
          \newcommand{\tick}{\textcolor{green}{\textsymbol{✓}}}
          \newcommand{\cross}{\textcolor{red}{\textsymbol{✘}}}          

          % Define chapter style
          \RedeclareSectionCommand[
            beforeskip=0pt, % No extra space before the chapter heading
            afterskip=6pt   % 6pt space after the chapter text
          ]{chapter}
    
          % Set chapter font properties
          \addtokomafont{chapter}{
            \fontsize{16pt}{18pt}\selectfont % Font size and line spacing
            \color[HTML]{0563C1} % Font color 
            \normalfont % Remove bold styling from chapter headings
          }
    
          % Remove chapter numbering
          \setkomafont{chapterprefix}{} % Disable "Chapter" prefix
          \renewcommand*{\thechapter}{} % Remove chapter numbering
          \renewcommand*{\chapterformat}{} % No numbering or formatting for chapters
          
          % Define custom section styling
          \addtokomafont{section}{
            \fontsize{12pt}{14pt}\selectfont % Font size and line spacing
            \color[HTML]{0563C1} % Font color 
            \bfseries % Bold text
            \MakeUppercase % Force all section headings to be uppercase
          }
          
          % Adjust spacing for level 1 sections
          \RedeclareSectionCommand[
            beforeskip=6pt, % 6pt space before the section
            afterskip=12pt   % 6pt space after the section
          ]{section}
          % Reset section numbering to use '1., 2., etc.'
          \renewcommand{\thesection}{\arabic{section}.}

           % Define custom subsection styling      
           \addtokomafont{subsection}{
            \fontsize{12pt}{14pt}\selectfont % Font size and line spacing
            \normalfont % Non-bold text
            \color[HTML]{0563C1} 
          }
          % Adjust spacing for subsections
          \RedeclareSectionCommand[
            beforeskip=6pt, % 6pt space before the subsection
            afterskip=6pt   % 6pt space after the subsection
          ]{subsection}
          % Reset subsection numbering to use '1.1., 1.2., etc.'
          \renewcommand{\thesubsection}{\thesection\arabic{subsection}.}
          
          
          % Define custom sub-subsection styling
          \addtokomafont{subsubsection}{
            \fontsize{11pt}{13pt}\selectfont % Font size 11pt with 13pt line spacing
            \color[HTML]{0563C1} 
            \normalfont % Non-bold text
            \itshape % Italic text
          }
    
          % Adjust spacing for sub-subsections
          \RedeclareSectionCommand[
            beforeskip=6pt, % 6pt space before the sub-subsection
            afterskip= 6pt   % 6pt space after the sub-subsection
          ]{subsubsection}
    
          % Reset sub-subsection numbering to use '1.1.1., 1.1.2., etc.'
          \renewcommand{\thesubsubsection}{\thesubsection\arabic{subsubsection}.}
          
          % fontsize bigger for focus headings
          \newcommand{\biggertext}[1]{{\bfseries\fontsize{12pt}{14pt}\selectfont #1}}
          
book:
  title: "Performance Review Body"
  subtitle: "Monitoring Report" 
  author: "{{< var doc.country >}} - {{< var doc.year_report >}}"
  chapters:
    - index.qmd


